$(document).ready(function(){$("#menu-list").searchable({searchField:"#menu-list-search",selector:"li",childSelector:".menu-text",show:function(elem){elem.slideDown(100)},hide:function(elem){elem.slideUp(100)}});$("#myCollapsible").collapse({toggle:false});$(".dropdown-toggle").dropdown()});var FLAG_NO="0";var FLAG_YES="1";var mainPageMenuFlag={"信用管理":FLAG_NO,"资金管理":FLAG_NO,"发票管理":FLAG_NO,"账户管理":FLAG_NO,"客户对账管理":FLAG_NO,"供应商对账管理":FLAG_NO};function addTab(url,title){if($("#tabsui").tabs("exists",title)){$("#tabsui").tabs("select",title)}else{if(mainPageMenuFlag[title]&&mainPageMenuFlag[title]!=FLAG_NO){mainPageMenuFlag[title]=FLAG_NO;return}var iframeid=url;var paramIndex=iframeid.indexOf("?");if(paramIndex!=-1){iframeid=iframeid.substring(0,paramIndex)}$("#tabsui").tabs("addIframeTab",{tab:{title:title,closable:true,tools:[{}]},iframe:{src:url,id:iframeid.replace(/\//g,"")}});$(".tabs-p-tool").remove()}if(title=="主页"){$(".tabs-first a").next().remove();$(".tabs-first a").removeClass("tabs-inner")}else{tabClose();tabCloseEven()}}function tabClose(){$(".tabs-inner").dblclick(function(){var subtitle=$(this).children("span").text();$("#tabsui").tabs("close",subtitle)});$(".tabs-inner").unbind("click");$(".tabs-inner").click(function(){var subtitle=$(this).children("span").text();var flagtitle="";$("#jquery-accordion-menu").find("span.menu-text").each(function(index){if($(this).parent().attr("onclick")&&$(this).parent().attr("onclick").split(",")[1].substring(1,$(this).parent().attr("onclick").split(",")[1].length-2)==subtitle){if($(this).parents("li").length>1){$(this).parents("li").each(function(){var onclickAttr=$(this).children("a").attr("onclick");if(onclickAttr){var onclickAttrSplit1=onclickAttr.split(",")[1];flagtitle=onclickAttrSplit1.substring(1,onclickAttrSplit1.length-2);if(mainPageMenuFlag[flagtitle]&&!$("#tabsui").tabs("exists",flagtitle)){mainPageMenuFlag[flagtitle]=FLAG_YES}}})}$(this).parents("li").each(function(){if($(this).attr("class")&&!$(this).children("a").hasClass("submenu-indicator-minus")){$(this).children("a").click()}});if($(this).parents("li").length==1){if($(this).parent().attr("onclick")){$(this).parent().next().find("a").removeClass("active")}}else{if($(this).parents("li").length==2){$(this).parent().click()}else{if($(this).parents("li").length==3){if(!$(this).parent().parent().parent().parent().children("a").hasClass("submenu-indicator-minus")){$(this).parent().parent().parent().parent().children("a").click()}$(this).parent().click()}}}}})});$(".tabs-inner").bind("contextmenu",function(e){$("#mm").menu("show",{left:e.pageX,top:e.pageY,});var subtitle=$(this).children("span").text();$("#mm").data("currtab",subtitle);return false})}function tabCloseEven(){$("#mm-tabclose").click(function(){var currtab_title=$("#mm").data("currtab");$("#tabsui").tabs("close",currtab_title)});$("#mm-tabcloseall").click(function(){$(".tabs-inner span").each(function(i,n){var t=$(n).text();if(t!="主页"){$("#tabsui").tabs("close",t)}})});$("#mm-tabcloseother").click(function(){var currtab_title=$("#mm").data("currtab");$(".tabs-inner span").each(function(i,n){var t=$(n).text();if(t!=currtab_title){if(t!="主页"){$("#tabsui").tabs("close",t)}}})})}function tableftactive(){$(".tabs-inner").click(function(){});$("#tabsui").tabs("close","信用管理")}$.extend($.fn.tabs.methods,{addEventParam:function(jq){return jq.each(function(){var that=this;var headers=$(this).find(">div.tabs-header>div.tabs-wrap>ul.tabs>li");headers.each(function(i){var tools=$(that).tabs("getTab",i).panel("options").tools;if(typeof tools!="string"){$(this).find(">span.tabs-p-tool a").each(function(j){$(this).unbind("click").bind("click",{handler:tools[j].handler},function(e){if($(this).parents("li").hasClass("tabs-disabled")){return}e.data.handler.call(this,e)})})}})})},loadTabIframe:function(jq,params){return jq.each(function(){var $tab=$(this).tabs("getTab",params.which);if($tab==null){return}var $tabBody=$tab.panel("body");var $frame=$("iframe",$tabBody);if($frame.length>0){try{$frame[0].contentWindow.document.write("");$frame[0].contentWindow.close()}catch(e){}$frame.remove();if($.browser.msie){CollectGarbage()}}$tabBody.html("");$tabBody.css({"overflow":"hidden"});var $containter=$('<div style="position:absolute;width:100%;height:100%;z-index:0;"></div>').appendTo($tabBody);var iframe=document.createElement("iframe");iframe.src=params.iframe.src;iframe.id=params.iframe.id;iframe.frameBorder=params.iframe.frameBorder||0;iframe.height=params.iframe.height||"100%";iframe.width=params.iframe.width||"100%";$containter[0].appendChild(iframe);$("#"+iframe.id).load(function(){$("#"+iframe.id).contents().find("body").append('<footer class="bs-docs-footer" role="contentinfo"><div class="container"><p>Copyright © 2012-2015 德邦物流股份有限公司. All rights reserved.沪ICP备10005645</p></div></footer')})})},addIframeTab:function(jq,params){return jq.each(function(){if(params.tab.href){delete params.tab.href}$(this).tabs("add",params.tab);$(this).tabs("loadTabIframe",{"which":params.tab.title,"iframe":params.iframe})
})},updateIframeTab:function(jq,params){return jq.each(function(){params.iframe=params.iframe||{};if(!params.iframe.src){var $tab=$(this).tabs("getTab",params.which);if($tab==null){return}var $tabBody=$tab.panel("body");var $iframe=$tabBody.find("iframe");if($iframe.length===0){return}$.extend(params.iframe,{"src":$iframe.attr("src")})}$(this).tabs("loadTabIframe",params)})}});